---
title: |
  \begin{center}
    \includegraphics[height=4cm]{logo.png} \\[1cm]
    \Large Econometría \\
  \end{center}
subtitle: "Prueba 1"
author:
  - name: "Amaru Simón Agüero Jiménez"
    email: "aaguero@miaundes.cl"
    orcid: "0000-0001-7336-1833"
date: "`r Sys.Date()`"
lang: es
format:
  pdf:
    toc: true
    number-sections: true
    documentclass: article
    fontsize: 10pt
    mainfont: "Arial"
    bibliography: ref.bib
    csl: apa-numeric-superscript.csl
    keep-tex: true
    header-includes: |
      % Paquetes necesarios
      \usepackage{amsmath}
      \usepackage{amssymb}
      \usepackage{graphicx}
      \usepackage{fancyhdr}
      \usepackage{geometry}
      \usepackage{booktabs}
      \usepackage{dcolumn}
      \usepackage{array}
      \newcolumntype{d}[1]{D{.}{.}{#1}}
      \usepackage{float}
      \usepackage{adjustbox}
      \renewcommand{\normalsize}{\fontsize{10pt}{12pt}\selectfont}
      
      % Configuración de márgenes
      \geometry{
        a4paper,
        left=1.5cm,
        right=1.5cm,
        top=1.5cm,
        bottom=2.5cm,
        includeheadfoot
      }

      % Configuración de encabezado y pie de página
      \pagestyle{fancy}
      \fancyhf{} % Limpia encabezado y pie de página
      
      % Encabezado
      \lhead{\includegraphics[height=1.5cm]{logo.png}} % Logo en el encabezado
      \chead{}
      \rhead{\small Econometría: Prueba 1.}

      % Ajuste de separación entre encabezado y contenido
      \setlength{\headheight}{2cm} % Altura del encabezado
      \setlength{\headsep}{1.5cm} % Distancia entre encabezado y contenido

      % Pie de página
      \lfoot{}
      \cfoot{\thepage} % Número de página centrado
      \rfoot{}
      
      
# Configuración de ejecución
execute:
  echo: false     # No mostrar código
  warning: false  # Sin advertencias
  message: false  # Sin mensajes
---

```{r}
install_and_load <- function(package) {
  if (!require(package, character.only = TRUE)) {
    utils::install.packages(package)
    library(package, character.only = TRUE)
  }
}

# lista de paqutes
packages <- c("knitr",
              "kableExtra", 
              "DT", 
              "table1",
              "tinytex",
              "stargazer",
              "gapminder",
              "latex2exp",
              "tidyverse",
              "ggpubr",
              "qrcode",
              "Hmisc",
              "RColorBrewer")

# funcion para instalar y cargar paquetes
invisible(capture.output(sapply(packages, install_and_load)))

# instalar despues de tinitex
# tinytex::install_tinytex()
# tinytex::tlmgr_install(c("booktabs", "xcolor", "array"))
```

# Caso.

Simular un proceso generador de datos para el tiempo que le toma a una persona, negociando sobre la venta de un artículo, llegar a un acuerdo. Nos interesa conocer los mecanismos psicológicos que operan detrás de las decisiones cooperativas de las personas frente a Conflictos de interés (juegos de suma cero). Interpretaremos el tiempo como una medida inversa de cooperación —i.e., ante mayor disposición de las personas para cooperar o compartir las ganancias de la negociación, menor debería ser el tiempo necesario para llegar a un acuerdo.

Creemos que las personas que perciban mayores niveles de Conflicto de intereses con su contraparte implementarán tácticas de negociación menos conciliadoras y tardarán más tiempo en llegar a un acuerdo. Esperamos, por lo tanto, una relación directa entre el Conflicto percibido y el tiempo para alcanzar un acuerdo en la negociación. Esperamos, que esta relación esté moderada por el rasgo de reciprocidad, donde personas con perfiles de cooperación no-condicionales tenderían a cooperar independientemente del Conflicto percibido.

Supondremos, para este ejercicio, que el tiempo necesario para ponerse de acuerdo (**en segundos**) es determinado **exclusivamente** por:

1. La percepción de Conflicto de interés (**en puntaje $z$**), de los participantes en la ronda de negociación, que medimos con la escala psicométrica Situational Interdependence Scale [@gerpott2018how].

2. El rasgo de reciprocidad (**dummy**), que medimos de la clasificación de los participantes como cooperadores condicionales/no-condicionales a partir de la técnica del Strategy Method (dCC) [@fischbacher2012behavioral].

3. El rasgo de pro-socialidad (**en puntaje $z$**), que medimos de la escala Social Value Orientation (SVO) [@murphy2011measuring].

La **variable independiente de interés** principal es la **percepción de Conflicto de interés**.


# Proceso generador de datos.

Simular un proceso de generación de datos según lo que se especifica a continuación. Asumir que el tiempo, la percepción de Conflicto de interés y la prosocialidad siguen distribuciones normales y que la reciprocidad sigue una distribución de Bernoulli. Utilizar los siguientes parámetros y semillas para generar los datos:

- muestra: $n = 50$
- tiempo: $\beta_0 = 350$, $\beta_{Conflicto} = 20$, $\beta_{\text{Conflicto} \times \text{dCC}} = 30$, $\beta_{svo} = -25$
- error: $\mathrm{E}(u) = 0$, $\mathrm{Var}(u|x) = \sigma^2 = 80^2$, seed = 6
- svo: $\mu_{svo} = 0$, $\sigma_{svo} = 1$, seed = 5
- Conflicto: $\mu_{Conflicto} = 0 - 0.5 \times svo$, $\sigma_{Conflicto} = 1$, seed = 2
- dcc: $\mu_{dcc} = 0.7$, seed = 45

```{r}
# Generación de datos
# muestra
n=50
# parámetros
beta_0 = 350
beta_Conflicto = 20
beta_Conflicto_dcc = 30
beta_svo = -25
# error
set.seed(6)
error = rnorm(n, mean = 0, sd = 80)
# pro-socialidad
set.seed(5)
svo = rnorm(n, mean = 0, sd = 1)
# Conflicto
set.seed(2)
Conflicto = rnorm(n, mean = 0 - 0.5 * svo, sd = 1)
# dcc
set.seed(45)
dcc = rbinom(n, 1, 0.7)
# tiempo
tiempo = beta_0 + beta_Conflicto * Conflicto + beta_Conflicto_dcc * Conflicto * dcc + beta_svo * svo + error

data = data.frame(tiempo, Conflicto, dcc, svo, error) %>%
  mutate(dcc = factor(dcc, levels = c(0, 1), labels = c("No Cooperador Condicional", "Cooperador Condicional")))
```

\newpage

# Pregunta 1. 

Describir el comportamiento de las variables de la muestra.

(a) Tomar estadísticas descriptivas de las variables. Incluir, al menos, la media, moda, mediana y el rango intercuartílico, cuando corresponda.
   
```{r}
#| results: 'asis'
# funcion para la moda
get_mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

# calcular estadisticas para variables continuas
continuous_stats <- data %>%
  select(tiempo, Conflicto, svo, error) %>%
  summarise(
    Variable = c("Tiempo", "Conflicto", "SVO"),
    Media = c(mean(tiempo), mean(Conflicto), mean(svo)),
    `Desviación Estándar` = c(sd(tiempo), sd(Conflicto), sd(svo)), 
    Moda = c(get_mode(tiempo), get_mode(Conflicto), get_mode(svo)),
    Mediana = c(median(tiempo), median(Conflicto), median(svo)),
    IQR = c(IQR(tiempo), IQR(Conflicto), IQR(svo))
  ) %>%
  mutate(across(where(is.numeric), ~ round(.x, 2)))

# calcular frecuencias y porcentajes para la variable categorica
categorical_stats <- data %>%
  count(dcc) %>%
  mutate(
    Porcentaje = n / sum(n) * 100,
    Variable = "DCC",
    Estadístico = paste0("Frecuencia de ", dcc),
    Valor = paste0(n, " (", round(Porcentaje, 2), "%)")
  ) %>%
  select(Variable, Estadístico, Valor) %>%
  mutate(across(where(is.numeric), ~ round(.x, 2)))

# combinar tablas
final_table <- continuous_stats %>%
  pivot_longer(cols = -Variable, names_to = "Estadístico", values_to = "Valor") %>%
  mutate(Valor = as.character(Valor)) %>% 
  bind_rows(categorical_stats)

# mostrar tabla en formato LaTeX con kable
kable(final_table, format = "latex", booktabs = TRUE, digits = 2, caption = "Estadísticas descriptivas de las variables") %>% kable_styling(latex_options = c("HOLD_position")) %>%
  collapse_rows(columns = 1, valign = "top")
```

\newpage

(b) Tomar gráficos de densidad y boxplot para variables continuas y gráfico de barras para variable categórica.

```{r}
#| fig-height: 8
#| fig-width: 10
#| results: asis
#| label: fig-fig1
#| fig-cap: "Distribución de las variables continuas y categórica"

# funcion para generar gráfico de densidad + boxplot
plot_variable <- function(df, var_name, label = NULL, max_y = NULL) {
  if (is.null(max_y)) {
    dens <- density(df[[var_name]], na.rm = TRUE)
    max_y <- max(dens$y) * 1.3
  }
  boxplot_position <- max_y * 1.2
  upper_limit <- max_y * 1.3
  
  ggplot(df, aes_string(x = var_name)) +
    geom_histogram(aes(y = ..density..),
                   fill = "gray80", colour = "white",
                   bins = 15) +
    geom_density(colour = "blue", size = 1) +
    geom_boxplot(aes(y = boxplot_position, x = .data[[var_name]]),
                 width = max_y * 0.04,
                 outlier.shape = 1) +
    coord_cartesian(ylim = c(0, upper_limit)) +
    scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +
    labs(
      title = paste("Distribución de", ifelse(is.null(label), var_name, label)),
      x     = ifelse(is.null(label), var_name, label),
      y     = "Densidad"
    ) +
    theme_minimal()
}

# funcion para generar grafico de barras para variable categorica
plot_categorical <- function(df, var_name,
                             label   = NULL,
                             palette = "Pastel1",
                             alpha   = 0.85) {
  cat_data <- df %>% 
    count(!!sym(var_name)) %>% 
    mutate(
      Porcentaje = n / sum(n) * 100,
      Etiqueta   = paste0(round(Porcentaje, 1), "%")
    )
  ggplot(cat_data,
         aes(x = !!sym(var_name), y = Porcentaje, fill = !!sym(var_name))) +
    geom_bar(stat = "identity", width = 0.6, alpha = alpha) +
    geom_text(aes(label = Etiqueta), vjust = -0.5, size = 4, colour = "grey15") +
    scale_fill_brewer(palette = palette, na.translate = FALSE) +
    
    labs(
      title = paste("Distribución de", ifelse(is.null(label), var_name, label)),
      x     = ifelse(is.null(label), var_name, label),
      y     = "Porcentaje (%)"
    ) +
    theme_minimal() +
    theme(
      legend.position = "none",
      text        = element_text(colour = "black"),
      axis.text   = element_text(colour = "grey20")
    ) +
    ylim(0, max(cat_data$Porcentaje) * 1.1)
}

# generamos cada plot
p1 <- plot_variable(data, "tiempo", "Tiempo")
p2 <- plot_variable(data, "Conflicto", "Conflicto")
p3 <- plot_variable(data, "svo", "SVO")
p4 <- plot_categorical(data, "dcc", "dCC (Cooperador Condicional)")

# unirlos con ggarrange
ggarrange(p1, p2, p3, p4, 
          ncol = 2, nrow = 2, 
          labels = c("A", "B", "C", "D"))
```

```{r}
#| fig-height: 8
#| fig-width: 10
#| results: asis
#| label: fig-fig2
#| fig-cap: "Correlación entre variables númericas"

# Función para crear gráfico de correlación con anotaciones
plot_correlation <- function(df, var1, var2, var1_label = NULL, var2_label = NULL) {
  if(is.null(var1_label)) var1_label <- var1
  if(is.null(var2_label)) var2_label <- var2
  cor_test <- cor.test(df[[var1]], df[[var2]])
  r_value <- cor_test$estimate
  p_value <- cor_test$p.value
  sig_label <- ifelse(p_value < 0.001, "***", 
                     ifelse(p_value < 0.01, "**",
                           ifelse(p_value < 0.05, "*", "ns")))
  
  cor_label <- sprintf("r = %.2f %s", r_value, sig_label)
  
  ggplot(df, aes_string(x = var1, y = var2)) +
    geom_point(alpha = 0.6, color = "gray40") +
    geom_smooth(method = "lm", color = "blue", fill = "lightblue", alpha = 0.3) +
    annotate("text", x = min(df[[var1]]), y = max(df[[var2]]), 
             label = cor_label, hjust = 0, vjust = 1, 
             fontface = "bold", size = 4) +
    labs(
      title = paste("Correlación entre", var1_label, "y", var2_label),
      x = var1_label,
      y = var2_label
    ) +
    theme_minimal()
}

p5 <- plot_correlation(data, "tiempo", "Conflicto", "Tiempo", "Conflicto")
p6 <- plot_correlation(data, "tiempo", "svo", "Tiempo", "SVO")
p7 <- plot_correlation(data, "Conflicto", "svo", "Conflicto", "SVO")

ggarrange(p5, p6, p7, 
          ncol = 2, nrow = 2, 
          labels = c("A", "B", "C"))

```

\newpage  

# Pregunta 2. 

Ajustar los 6 modelos lineales que se detallan a continuación, exportar tabla con `stargazer()` e interpretar coeficientes y resultados de cada modelo. Comparar y explicar diferencias entre los modelos.

   (a) $tiempo \sim Conflicto$

   (b) $tiempo \sim Conflicto + svo$

   (c) $tiempo \sim Conflicto + dcc$

   (d) $tiempo \sim Conflicto + dcc + svo$

   (e) $tiempo \sim Conflicto + Conflicto \times dcc + dcc$

   (f) $tiempo \sim Conflicto + Conflicto \times dcc + dcc + svo$

En base a lo anterior se formulan los siguiente modelos

- $modelo\;1:\; \text{tiempo}_i= \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i+ u_i$

- $modelo\;2:\; \text{tiempo}_i= \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i + \beta_{\text{SVO}}\times\text{SVO}_i+ u_i$

- $modelo \; 3:\; \text{tiempo}_i= \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i + \beta_{\text{dCC}}\times\text{dCC}_i+ u_i$

- $modelo\;4:\; \text{tiempo}_i = \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i+ \beta_{\text{SVO}}\times\text{SVO}_i+ \beta_{\text{dCC}}\times\text{dCC}_i+ u_i$

- $modelo\;5:\; \text{tiempo}_i= \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i + \beta_{\text{dCC}}\times\text{dCC}_i + \beta_{\text{Conflicto}\times\text{dCC}}\;      \times(\text{Conflicto}_i\times\text{dCC}_i) + u_i$

- $modelo\;6:\; \text{tiempo}_i = \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i + \beta_{\text{SVO}}\times\text{SVO}_i + \beta_{\text{dCC}}\times\text{dCC}_i + \beta_{\text{Conflicto}\times\text{dCC}}\times(\text{Conflicto}_i\times\text{dCC}_i) + u_i$

```{r}
#| results: asis
modelo1 <- lm(tiempo ~ Conflicto, data = data)
modelo2 <- lm(tiempo ~ Conflicto + svo, data = data)
modelo3 <- lm(tiempo ~ Conflicto + dcc, data = data)
modelo4 <- lm(tiempo ~ Conflicto + dcc + svo, data = data)
modelo5 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc, data = data)
modelo6 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc + svo, data = data)

# crear tabla con stargazer en formato latex

stargazer(modelo1, modelo2, modelo3, modelo4, modelo5, modelo6,
          type = "latex",
          title = "Resultados de los modelos lineales ajustados",
          dep.var.labels = "Tiempo (segundos)",
          column.labels = c("modelo 1", "modelo 2", "modelo 3", "modelo 4", "modelo 5", "modelo 6"),
          covariate.labels = c("Conflicto", "SVO", "dCC Si", "Conflicto $\\times$ dCC Si."),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001),
          model.numbers = FALSE,
          header = FALSE,
          font.size = "scriptsize",
          no.space = TRUE,
          single.row = TRUE,  
          table.placement = "H")

```
En la Tabla 2 se observan los resultados de los modelos lineales con método de estimación Ordinary Least Squares (OLS), bajo el contraste de hipótesis en donde $H_0:\beta_i=0$ y $H_1:\beta_i\neq0$. Todos los modelos poseen un $R^2$ estadisticamente distinto al modelo nulo, indicando un aumento de la capacidad predictiva al ingresar las variables independientes.

En el **modelo 1** el intercepto o $\hat{\beta}_0$ es de 356.99 segundos y significativo (*p*<0.001), representando el tiempo promedio estimado cuando el Conflicto está en su valor medio (0 en escala *z*).  El coeficiente $\hat{\beta}_{\text{Conflicto}}$ es positivo (52.72) y significativo (*p*<0.001), lo que indica que existe un aumento de 52.72 segundos en el tiempo de negociación por cada desviación estándar que aumenta la percepción de Conflicto. De forma análoga, se espera una disminución de 52.72 segundos si la percepción de Conflicto disminuye en una desviación estándar. Respecto a los estadísticos $R^2 = 0.31$ y $R^2_{\text{ajustado}} = 0.30$ muestran que el Conflicto por sí solo explica aproximadamente 31 % de la variabilidad del tiempo de negociación, un aporte considerable para un único predictor.

En el **modelo 2** el intercepto o $\hat{\beta}_0$ es 359.00 segundos y significativo (*p*<0.001), representando el tiempo promedio estimado cuando el Conflicto y SVO están en su valor medio (0 en escala *z*). El coeficiente $\hat{\beta}_{\text{Conflicto}}$ se reduce a 45.90 (*p*<0.001), manteniendo su efecto positivo. El coeficiente de prosocialidad $\hat{\beta}_{\text{SVO}}$ es –27.13 y significativo (*p*<0.05), lo que implica se acorta el tiempo de negociación en 27.13 segundos por cada desviación estándar adicional en SVO, reflejando que individuos más prosociales cooperan más rápido. El ajuste mejora a $R^2 = 0.38$ y $R^2_{\text{ajustado}} = 0.35$, indicando que SVO incrementa la varianza explicada en siete puntos porcentuales respecto al **modelo 1**.

Al comparar $\hat{\beta}_{\text{Conflicto}}$ en el **modelo 1** y el **modelo 2**, con la correlacion negativa observada en la @fig-fig2 y dada la siguiente relación en la Tabla 3 se observa un sesgo positivo en $\hat{\beta}_{\text{Conflicto}}$ al omitir SVO en el __modelo 1__ y explica la reducion del coeficiente $\hat{\beta}_{\text{Conflicto}}$ en el **modelo 2**.

Table: Dirección del sesgo en la estimación del coeficiente de SVO según la correlación con la variable Conflicto

|   | $\text{Corr}(x_{\text{Conflicto}}, x_{\text{SVO})} > 0$ | $\text{Corr}(x_{\text{Conflicto}}, x_{\text{SVO})} < 0$ |
|------------------|:-------------------------:|:-------------------------:|
| $\hat\beta_{\text{SVO}} > 0$ | Positive bias | Negative bias |
| $\hat\beta_{\text{SVO}} < 0$ | Negative bias | **Positive bias** |

En el **modelo 3** el intercepto, $\hat{\beta}_0$ es de 393.48 segundos (*p*<0.001), representa el tiempo promedio de negociación estimado para un participante no condicional (dCC=0) cuando la percepción de Conflicto se encuentra en su valor medio (0 en escala *z*). El $\hat{\beta}_{\text{Conflicto}}$ aumenta en comparacion al **modelo 2** (dado el sesgo positivo por omitir SVO) y mantiene su significancia estadistica (*p*<0.001). Esto indica que el tiempo de negociación se incrementa en 54.98 segundos , cuando la percepción de Conflicto aumenta en una desviación estándar; de forma análoga, disminuye en la misma magnitud si la percepción de Conflicto cae una desviación estándar. En este modelo tambien se observa una reducción de 44.60 segundos cuando hay reciporcidad pero como el $\hat{\beta}_{\text{dCC}}$ es no signicativo (*p*>0.05), este coeficiente tiene una probabilidad que su valor sea 0 o incluso positivo (dado su intervalo de confianza). Por último el modelo explica un 34% de la variabilidad del tiempo ($R^2 = 0.34$, $R^2_{\text{ajustado}} = 0.31$), solo presenta una mejora modesta respecto al **modelo 1**.

En el **modelo 4** el intercepto $\hat{\beta}_0$ es de 395.09 segundos (*p*<0.001) e indica el tiempo esperado para un participante no condicional (dCC = 0), con valores medios de Conflicto y SVO (0 en escala *z*). El coeficiente $\hat{\beta}_{\text{Conflicto}}$ se reduce nuevamente a 48.16 (*p*<0.001) (Por sesgo positivo de SVO sobre Conflicto). Esto indica el tiempo aumenta en 48.16 segundos por Un aumento de una desviación estándar en Conflicto. Por otra parte, el coeficiente de prosocialidad $\hat{\beta}_{\text{SVO}}$ es –27.02 y significativo (*p*<0.05), reduciendo el tiempo de negociación en 27.02 segundos por cada desviación estándar adicional en orientación prosocial (SVO). Esto nuevamente refleja que los individuos más prosociales cooperan con mayor rapidez. El coeficiente asociado a la reciprocidad $\hat{\beta}_{\text{dCC}}$ sigue siendo negativo (–44.12 segundos) pero no significativo. Con $R^2 = 0.40$ y $R^2_{\text{ajustado}} = 0.36$, este modelo incrementa la varianza explicada hasta el 40%, subrayando la importancia conjunta del Conflicto y la prosocialidad.

En el **modelo 5** se incorpora la interacción Conflicto × dCC. El intercepto, $\hat{\beta}_0$ = 383.19 segundos (*p*<0.001), corresponde al tiempo promedio para un participante no condicional cuando la percepción de Conflicto tiene promedio 0 (0 en escala *z*). El ingreso de la interación provoca la perdida de la significancia del coeficiente  $\hat{\beta}_{\text{Conflicto}}$, mantiene la no significancia del coeficiente $\hat{\beta}_{\text{dCC}}$ y la interación con el coeficiente $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ tambien es no significativa. Respecto al ajuste global ($R^2 = 0.35$, $R^2_{\text{ajustado}} = 0.31$) permanece por debajo del obtenido cuando se incluye SVO (**modelo 4**).

En el **modelo 6**, que combina Conflicto, SVO, dCC y su interacción, el intercepto se estima en $\hat{\beta}_0$  = 384.38 segundos (*p*<0.001)e indica el tiempo esperado para un participante no condicional con valores medios de Conflicto y SVO (0 en escala *z*) y  dCC: No. Entre los participantes no condicionales, el Conflicto muestra un coeficiente de 15.42 segundos por desviación estándar, sin significancia estadística. La orientación prosocial mantiene un efecto negativo robusto: El tiempo de negociación se reduce en 27.35 segundos (*p* <0.05) por cada desviación estándar extra en SVO. Ni el coeficiente principal de reciprocidad $\hat\beta_{\text{dCC}}$  (–34.03 segundos) ni el coeficiente de interacción $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ (38.12 segundos) resultan significativos. Pese a ello, el modelo muestra el mayor ajuste global, explicando el 42 % de la variación observada ($R^2 = 0.42$, $R^2_{\text{ajustado}} = 0.37$); la ganancia respecto al **modelo 4** es modesta y se atribuye principalmente a la mayor flexibilidad del modelo más que a evidencia estadística de un efecto de moderación.

En conjunto, estos resultados reafirman el tiempo de negociación se incrementa con un aumento en la percepción de Conflicto y que la orientación prosocial lo reduce, mientras que los efectos vinculados a la reciprocidad y su interacción con el Conflicto no son significativos con la muestra actual.


# Pregunta 3. 

¿Cuál modelo cree que especifica correctamente la hipótesis a probar y por qué?


La hipótesis planteada sostiene que **el tiempo de negociación es infleunciado por la percepción de Conflicto** y que este **efecto se ve moderado por el tipo de cooperador** (dCC: no cooperador condicional = 0, cooperador condicional = 1).

Formalmente: $H_0:\;\beta_{\text{Conflicto}\times\text{dCC}} = 0$ frente a $H_1:\;\beta_{\text{Conflicto}\times\text{dCC}} \neq 0$. 

Para operacionalizarla, el modelo que incluye todos los términos necesarios es el **modelo 6**: $\text{tiempo}_i = \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i + \beta_{\text{SVO}}\times\text{SVO}_i + \beta_{\text{dCC}}\times\text{dCC}_i + \beta_{\text{Conflicto}\times\text{dCC}}\times(\text{Conflicto}_i\times\text{dCC}_i) + u_i$
Al estimar el **modelo 6** ninguno de los coeficientes asociados a la moderación de conflcito es estadísticamente significativo (*p*>0,05). Esta pérdida de significancia en comparacion a los **modelos 1 , 2, 3 y 4** se explica, en gran medida, por dos factores: la multicolinealidad inducida entre Conflicto y el término de interacción, que eleva los errores estándar de $\beta_{\text{Conflicto}}$ y $\beta_{\text{Conflicto}\times\text{dCC}}$, y el tamaño muestral reducido (n = 50), que limita la potencia para detectar efectos moderadores de magnitud moderada.

Aunque **modelo 6** captura fielmente la hipótesis teórica, su leve ganancia de ajuste ($\Delta R^2 = 0,01$) no compensa la mayor complejidad ni el aumento en la varianza de los estimadores. Por el contrario, el modelo **modelo 4**: $\text{tiempo}_i = \beta_0 + \beta_{\text{Conflicto}}\times\text{Conflicto}_i+ \beta_{\text{SVO}}\times\text{SVO}_i+ \beta_{\text{dCC}}\times\text{dCC}_i+ u_i$ presenta coeficientes $\beta_{\text{Conflicto}}$, $\beta_{\text{SVO}}$ y $\beta_{\text{dCC}}$ significativos, evita la colinealidad excesiva, evita el sesgo positivio de variable omitida de SVO y conserva la parsimonia, ofreciendo una interpretación más estable y directa del efecto principal de Conflicto controlando por SVO y dCC.

\newpage

# Pregunta 4. 

Repetir punto 2 volviendo a tomar una muestra de tiempo con $\beta_{\text{Conflicto} \times \text{dCC}} = 10$.

```{r}
#| results: asis
# parametros
beta_0 = 350
beta_Conflicto = 20
beta_Conflicto_dcc = 10
beta_svo = -25
set.seed(6)
error = rnorm(n, mean = 0, sd = 80)
set.seed(5)
svo = rnorm(n, mean = 0, sd = 1)
set.seed(2)
Conflicto = rnorm(n, mean = 0 - 0.5 * svo, sd = 1)
set.seed(45)
dcc = rbinom(n, 1, 0.7)
# tiempo
tiempo = beta_0 + beta_Conflicto * Conflicto + beta_Conflicto_dcc * Conflicto * dcc + beta_svo * svo + error

data2 = data.frame(tiempo, Conflicto, dcc, svo, error) %>%
  mutate(dcc = factor(dcc, levels = c(0, 1), labels = c("No Cooperador Condicional", "Cooperador Condicional")))

modelo1.2 <- lm(tiempo ~ Conflicto, data = data2)
modelo2.2 <- lm(tiempo ~ Conflicto + svo, data = data2)
modelo3.2 <- lm(tiempo ~ Conflicto + dcc, data = data2)
modelo4.2 <- lm(tiempo ~ Conflicto + dcc + svo, data = data2)
modelo5.2 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc, data = data2)
modelo6.2 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc + svo, data = data2)


# tabla con stargazer en formato latex

stargazer(modelo1.2, modelo2.2, modelo3.2, modelo4.2, modelo5.2, modelo6.2,
          type = "latex",
          title = "Resultados de los modelos lineales ajustados $\\beta_{Conflicto \\times dcc}$ = 10",
          dep.var.labels = "Tiempo (segundos)",
          column.labels = c("modelo 1.2", "modelo 2.2", "modelo 3.2", "modelo 4.2", "modelo 5.2", "modelo 6.2"),
          covariate.labels = c("Conflicto", "SVO", "dCC Si", "Conflicto $\\times$ dCC Si."),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001),
          model.numbers = FALSE,
          header = FALSE,
          font.size = "scriptsize",   
          no.space = TRUE,   
          single.row = TRUE,    
          table.placement = "H")  

```

En la Tabla 4 se observa los resutados de los modelos lineales ajustados con el nuevo valor de $\beta_{\text{Conflicto} \times \text{dCC}}$ = 10. Todos los modelos poseen un $R^2$ estadisticamente distinto al modelo nulo, indicando un aumento de la capacidad predictiva al ingresar las variables independientes, pero hay modelos con coeficientes menos significativos como el **modelo 5.2**. 

Ahora en particular para el **modelo 1.2**, se observa que tanto el intercepto ($\hat{\beta}_{0}$ = 355.69) como el coeficiente para Conflicto ($\hat{\beta}_{\text{Conflicto}}$) son significativos. Este modelo, con un $R^2 = 0.18$ y $R^2_{\text{ajustado}} = 0.16$, menor que el **modelo 1** con un $\beta_{\text{Conflicto} \times \text{dCC}}$ = 30, (disminución del efecto de la interacción). Este modelo tambien indica que hay un aumento de tiempo de negociación por un aumento en una desvision estadar de la percepción de Conflicto.

En el **modelo 2.2**, los coeficientes para el intercepto ($\hat{\beta}_{0}$ = 357.71), Conflicto ($\hat{\beta}_{\text{Conflicto}}$ = 29.00^) y SVO ($\hat{\beta}_{\text{SVO}}$ = -27.29) son todos significativos. El modelo presenta un $R^2 = 0.26$ y un $R^2_{\text{ajustado}} = 0.23$, tambien menor que el **modelo 2** . Estos resultados sugieren que mientras el Conflicto incrementa el tiempo de negociación, una mayor orientación al valor social (SVO o prosocialidad) lo disminuye de forma significativa, mejorando el ajuste general en comparación con el **modelo 1.2**.

El **modelo 3.2** muestra coeficientes significativos para el intercepto ($\hat{\beta}_{0}$ = 387.85) y para Conflicto ($\hat{\beta}_{\text{Conflicto}}$ = 37.85^). Sin embargo, el coeficiente para la variable dCC (ser cooperador condicional, $\hat{\beta}_{\text{dCC}}$ = -38.83) no resulta estadísticamente significativo. El modelo tiene un $R^2 = 0.20$ y un $R^2_{\text{ajustado}}$ = 0.17, indicando que el tipo de cooperador dCC no tiene un impacto discernible en el tiempo de negociación en este modelo.

Respecto al **modelo 4.2**, este presenta coeficientes significativos para el intercepto ($\hat{\beta}_{0}$ = 389.47), Conflicto ($\hat{\beta}_{\text{Conflicto}}$ = 30.99) y SVO ($\hat{\beta}_{\text{SVO}}$ = -27.19). Al igual que en el modelo anterior, el coeficiente para dCC Si ($\hat{\beta}_{\text{dCC}}$ = -39.31) no es significativo. Con un $R^2 = 0.28$ y un $R^2_{\text{ajustado}} = 0.24$, este modelo ofrece un buen balance, mostrando que el Conflicto aumenta el tiempo y SVO lo disminuye, sin un efecto claro de dCC.

Para el **modelo 5.2**, únicamente el intercepto ($\hat{\beta}_{0}$ = 383.19) es significativo. Los coeficientes para Conflicto ($\hat{\beta}_{\text{Conflicto}}$ = 23.65), dCC Si ($\hat{\beta}_{\text{dCC}}$ = -34.93) y la interacción Conflicto x dCC Si ($\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ = 16.57) no son estadísticamente significativos. El $R^2 = 0.21$ y el $R^2_{\text{ajustado}} = 0.15$ sugieren que la inclusión de la interacción, en estas condiciones, no mejora la comprensión del fenómeno y reduce el ajuste en comparación con modelos más simples que incluyen SVO.

En el **modelo 6.2**, los coeficientes significativos son el intercepto ($\hat{\beta}_{0}$ = 384.38) y SVO ($\hat{\beta}_{\text{SVO}}$ = -27.35). Los términos para Conflicto ($\hat{\beta}_{\text{Conflicto}}$ = 15.42), dCC Si ($\hat{\beta}_{\text{dCC}}$ = -34.03) y la interacción Conflicto x dCC Si ($\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ = 18.12) no resultan significativos. Aunque este modelo completo presenta el $R^2$ más alto (0.29), su $R^2_{\text{ajustado}}$ (0.22) es superado por el **modelo 4.2**, indicando que la complejidad adicional no se justifica por la mejora en el ajuste.

La reducción del parámetro $\beta_{\text{Conflicto} \times \text{dCC}}$ de un valor hipotético mayor (ej. 30, como en la primera parte del ejercicio del documento) a 10 en el proceso generador de datos, tiene implicaciones para la interpretación de los modelos, especialmente considerando un tamaño muestral de $n=50$. En ambas tablas SVO es significativo y  refleja un sesgo postivo sobre Conflicto. Otro aspecto en la comparación es la significancia y magnitud del término de interacción ($\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$). En la Tabla 2, con $\beta_{\text{Conflicto} \times \text{dCC}} = 30$, el modelo 6, presentó un coeficiente estimado para la interacción $\hat\beta_{\text{Conflicto} \times \text{dCC}}$ de 38.12. Notablemente, a pesar de la considerable magnitud del efecto real simulado (30), este término no resultó estadísticamente significativo con $n=50$. Se sugiere que esta falta de significancia podría atribuirse, en parte, a la multicolinealidad y al tamaño muestral reducido, que limita la potencia estadística. En la Tabla 4, con $\beta_{\text{Conflicto} \times \text{dCC}}$ = 10), en el modelo 6.2 (equivalente al modelo 6 del escenario anterior), el coeficiente estimado para la misma interacción fue $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ = 18.12 , y este término tampoco resultó estadísticamente significativo. Al comparar ambos escenarios, se evidencia que la no significancia estadística del término de interacción es un resultado consistente para $n=50$, lo que subraya la dificultad de detectar efectos de interacción con muestras pequeñas.

# Pregunta 5. 

Repetir la simulación incrementando el tamaño de la muestra a 300 observaciones, tanto para $\beta_{\text{Conflicto} \times \text{dCC}} = 30$ como para $\beta_{\text{Conflicto} \times \text{dCC}} = 10$ (en total en la prueba hay 4 escenarios, 2 tamaño de muestra $\ast$ 2 $\beta_{\text{Conflicto} \times \text{dCC}}$). Comparar con resultados anteriores y explicar posibles causas de las diferencias.

```{r}
#| results: asis
# generacion de datos para n=300 con B_Conflicto×dcc = 30
n_grande = 300
# parametros
beta_0 = 350
beta_Conflicto = 20
beta_Conflicto_dcc = 30
beta_svo = -25
set.seed(6)
error = rnorm(n_grande, mean = 0, sd = 80)
set.seed(5)
svo = rnorm(n_grande, mean = 0, sd = 1)
set.seed(2)
Conflicto = rnorm(n_grande, mean = 0 - 0.5 * svo, sd = 1)
# dcc
set.seed(45)
dcc = rbinom(n_grande, 1, 0.7)
# tiempo
tiempo = beta_0 + beta_Conflicto * Conflicto + beta_Conflicto_dcc * Conflicto * dcc + beta_svo * svo + error

data3 = data.frame(tiempo, Conflicto, dcc, svo, error) %>%
  mutate(dcc = factor(dcc, levels = c(0, 1), labels = c("No Cooperador Condicional", "Cooperador Condicional")))

# modelos para n=300 con B_Conflicto×dcc = 30
modelo1.3 <- lm(tiempo ~ Conflicto, data = data3)
modelo2.3 <- lm(tiempo ~ Conflicto + svo, data = data3)
modelo3.3 <- lm(tiempo ~ Conflicto + dcc, data = data3)
modelo4.3 <- lm(tiempo ~ Conflicto + dcc + svo, data = data3)
modelo5.3 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc, data = data3)
modelo6.3 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc + svo, data = data3)

# tabla con stargazer en formato latex
stargazer(modelo1.3, modelo2.3, modelo3.3, modelo4.3, modelo5.3, modelo6.3,
          type = "latex",
          title = "Resultados de los modelos lineales ajustados (n=300, $\\beta_{Conflicto \\times dcc} = 30$)",
          dep.var.labels = "Tiempo (segundos)",
          column.labels = c("modelo 1.3", "modelo 2.3", "modelo 3.3", "modelo 4.3", "modelo 5.3", "modelo 6.3"),
          covariate.labels = c("Conflicto", "SVO", "dCC Si", "Conflicto $\\times$ dCC Si"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001),
          model.numbers = FALSE,
          header = FALSE,
          font.size = "tiny",
          no.space = TRUE,
          single.row = TRUE,
          table.placement = "H")
```


Al contrastar los resultados de la Tabla 2 (modelos con $n=50$) y la Tabla 5 (modelos con $n=300$), ambas generadas con un parámetro de interacción $\beta_{\text{Conflicto} \times \text{dCC}} = 30$, se aprecian cambios significativos atribuibles al aumento en el tamaño muestral. Una de las diferencias más importantes y reveladoras se manifiesta en el coeficiente de interacción $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$. Mientras que con una muestra de $n=50$, esta interacción no resultaba estadísticamente significativa en los modelos más completos (por ejemplo, en el **modelo 6** de Tabla 2, el coeficiente $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ era 38.12, no significativo), al aumentar la muestra a $n=300$ (Tabla 5), este término se vuelve claramente significativo y su valor estimado se aproxima más al parámetro real utilizado en la simulación (por ejemplo, en el modelo 6.3, $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ es de 32.56, *p* < 0.001). Este cambio subraya cómo el incremento del tamaño muestral dota al modelo de la potencia necesaria para detectar efectos de moderación que teóricamente se esperaban.

Dada la significancia adquirida por la interacción, su interpretación se vuelve importante sobre todo en los **modelos 6 y 6.3**. Para los cooperadores no condicionales (asumiendo dCC = 0), el efecto de un aumento de una unidad en la percepción de Conflicto sobre el Tiempo de negociación está dado directamente por el coeficiente principal de Conflicto. En el **modelo 6.3** de la Tabla 5, este coeficiente ($\hat{\beta}_{\text{Conflicto}}$) es de 20.82 (y es significativo, *p* < 0.01). Esto significa que, para este grupo, un aumento de aproximadamente 20.82 segundos en el tiempo de negociación dado un incremento de una desviación estándar en la percepción de conflicto. En cambio, para los cooperadores condicionales (asumiendo dCC = 1), el auemnto del Tiempo de negociación es dado un aumento de una unidad en la percepción de Conflicto es la suma del coeficiente principal de Conflicto y el coeficiente de la interacción, resultando en $20.82 + 32.56 = 53.38$ segundos.

La interacción positiva y significativa de 32.56 indica que el impacto de la percepción de conflicto sobre el tiempo de negociación es considerablemente más pronunciado para los cooperadores condicionales en comparación con los cooperadores no condicionales. Aunque el aumento del tiempo de negociación dado el conflicto existe para ambos grupos, este aumento es sustancialmente mayor (específicamente, en 32.56 segundos adicionales por cada desviación estandar de incremento en conflicto) para aquellos individuos que son cooperadores condicionales. En términos sustantivos, esto podría interpretarse como una mayor sensibilidad o reactividad de los cooperadores condicionales a los niveles de conflicto percibido. Cuando el conflicto aumenta, su disposición a cooperar (que se reflejaría en un menor tiempo de negociación) parece disminuir más drásticamente que la de los cooperadores no condicionales, lo que los lleva a tardar considerablemente más tiempo en alcanzar un acuerdo. Este hallazgo, que emerge con gracias a la potencia estadística proporcionada por la muestra de $n=300$, da un soporte empírico más robusto a la hipótesis de que la reciprocidad (representada por la distinción entre cooperadores condicionales y no condicionales) modera la relación entre el conflicto y el tiempo de negociación, especificando que esta moderación se traduce en una sensibilidad agudizada al conflicto por parte de los cooperadores condicionales.

Además del término de interacción, el efecto principal de Conflicto en el modelo completo (**Modelo 6.3** de Tabla 5) también alcanza significancia estadística y se más preciso respecto al parametro poblaciona con la muestra ampliada. En donde ($\hat{\beta}_{\text{Conflicto}}$ es 20.82, *p* < 0.01), a diferencia de la situación con $n=50$, donde no es significativo en el mismo tipo de modelo (Modelo 6 de Tabla 2, $\hat{\beta}_{\text{Conflicto}}$ es 15.42, no significativo). Esta es otra manifestación del aumento de la potencia estadística, tambien permitiendo identificar la precencia  sesgo positivo de variavble omitida al excluir la interaccion en el **modelo 5.3**. En contraste con estos cambios, la variable SVO demuestra una notable estabilidad: mantiene su significancia estadística en ambos tamaños muestrales, y su coeficiente estimado permanece relativamente constante (alrededor de -27 en los modelos completos), con un nivel de significancia que se robustece aún más con $n=300$ (generalmente *p* < 0.001).

Respecto al efecto principal de $\hat{\beta}_{\text{dCC}}$ (ser cooperador condicional), este sigue siendo no significativo incluso con $n=300$ en la mayoría de los modelos (por ejemplo, en el **modelo 6.3** de la Tabla 5, $\hat{\beta}_{\text{dCC}}$ es -4.66, no significativo). Es importante notar que, aunque sigue siendo no significativo, el valor absoluto de su coeficiente disminuye considerablemente en comparación con las estimaciones obtenidas con $n=50$ (que era -34.03 en el modelo 6 de Tabla 2). Esta persistente no significancia del coeficiente principal de $\hat{\beta}_{\text{dCC}}$, ahora con una estimación más precisa (menor error estándar debido a $n=300$) y un valor más cercano a cero. Esto indica que no hay una diferencia estadísticamente significativa en el intercepto (es decir, en el tiempo de negociación cuando el conflicto es cero y SVO es cero) entre los cooperadores no condicionales (dCC = 0) y los cooperadores condicionales (dCC = 1). La diferencia entre estos grupos se manifiesta, como se discutió, a través de cómo responden diferencialmente al conflicto (la interacción), más que por una diferencia base en sus tiempos de negociación.

Finalmente, el ajuste general de los modelos, medido por el $R^2_{\text{ajustado}}$, también tiende a mejorar con la muestra mayor. Por ejemplo, el **modelo 6.3** ($n=300$) alcanza un $R^2_{\text{ajustado}}$ de 0.43, lo cual es superior al 0.37 obtenido por el **modelo 6** ($n=50$), indicando que el modelo con la muestra mayor explica una porción ligeramente mayor de la variabilidad en el tiempo de negociación.

```{r}
#| results: asis
# generacion de datos para n=300 con B_Conflicto×dcc = 10
# parametros
beta_0 = 350
beta_Conflicto = 20
beta_Conflicto_dcc = 10  # Segundo escenario
beta_svo = -25
set.seed(6)
error = rnorm(n_grande, mean = 0, sd = 80)
set.seed(5)
svo = rnorm(n_grande, mean = 0, sd = 1)
set.seed(2)
Conflicto = rnorm(n_grande, mean = 0 - 0.5 * svo, sd = 1)
set.seed(45)
dcc = rbinom(n_grande, 1, 0.7)
# tiempo
tiempo = beta_0 + beta_Conflicto * Conflicto + beta_Conflicto_dcc * Conflicto * dcc + beta_svo * svo + error

data4 = data.frame(tiempo, Conflicto, dcc, svo, error) %>%
  mutate(dcc = factor(dcc, levels = c(0, 1), labels = c("No Cooperador Condicional", "Cooperador Condicional")))

# modelos para n=300 con B_Conflicto×dcc = 10
modelo1.4 <- lm(tiempo ~ Conflicto, data = data4)
modelo2.4 <- lm(tiempo ~ Conflicto + svo, data = data4)
modelo3.4 <- lm(tiempo ~ Conflicto + dcc, data = data4)
modelo4.4 <- lm(tiempo ~ Conflicto + dcc + svo, data = data4)
modelo5.4 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc, data = data4)
modelo6.4 <- lm(tiempo ~ Conflicto + Conflicto * dcc + dcc + svo, data = data4)

# tabla con stargazer en formato latex
stargazer(modelo1.4, modelo2.4, modelo3.4, modelo4.4, modelo5.4, modelo6.4,
          type = "latex",
          title = "Resultados de los modelos lineales ajustados (n=300, $\\beta_{Conflicto \\times dcc} = 10$)",
          dep.var.labels = "Tiempo (segundos)",
          column.labels = c("modelo 1.4", "modelo 2.4", "modelo 3.4", "modelo 4.4", "modelo 5.4", "modelo 6.4"),
          covariate.labels = c("Conflicto", "SVO", "dCC Si", "Conflicto $\\times$ dCC Si"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001),
          model.numbers = FALSE,
          header = FALSE,
          font.size = "tiny",
          no.space = TRUE,
          single.row = TRUE,
          table.placement = "H")
```

Al comparar los resultados de la Tabla 4 (modelos con $n=50$) y la Tabla 6 (modelos con $n=300$), ambas generadas con un parámetro de interacción más débil $\beta_{\text{Conflicto} \times \text{dCC}}=10$, también se observa el impacto del incremento en el tamaño muestral, aunque con matices respecto al escenario anterior. El comportamiento del coeficiente interacción $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ es constante. Este término, que no era significativo con $n=50$ (por ejemplo, en el modelo 6.2 de Tabla 4, $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ era 18.12), sigue sin ser estadísticamente significativo incluso con $n=300$ (por ejemplo, en el modelo 6.4 de Tabla 6, $\hat{\beta}_{\text{Conflicto} \times \text{dCC}}$ es 12.56). Aunque el coeficiente estimado con $n=300$ se acerca al valor verdadero del parámetro ($\beta=10$) y su error estándar disminuye (indicando una estimación más precisa), la magnitud intrínseca del efecto es tan pequeña que la muestra de 300 observaciones aún no proporciona la potencia estadística suficiente para detectarlo de manera concluyente como distinto de cero. Esto revela que un tamaño muestral mayor ayuda, pero no garantiza la significancia si el efecto real es muy sutil.

En cuanto a la variable SVO, esta continúa demostrando ser un predictor robusto y consistentemente significativo en ambos tamaños de muestra. Sus coeficientes se mantienen estables (alrededor de -27 en los modelos completos) y su nivel de significancia se consolida con $n=300$ (generalmente *p* < 0.001), reflejando un efecto claro y detectable independientemente de la muestra (dentro de estos rangos) y de la fuerza de la interacción.

Respecto al efecto principal de Conflicto, este si cambia de significancia entre los modelos. En el modelo 5.2 (Tabla 4), el coeficiente de Conflicto ($\hat{\beta}_{\text{Conflicto}}$) era 23.65, no significativo, mientras que en el **modelo 5.4** (Tabla 6), este coeficiente se convierte en significativo ($\hat{\beta}_{\text{Conflicto}}$ = 20.82, *p* < 0.01). Este cambio resalta cómo un tamaño muestral mayor puede ayudar a detectar efectos que antes eran indetectables debido a la variabilidad inherente en muestras más pequeñas. En relación a el efecto principal de dCC Si ($\hat{\beta}_{\text{dCC}}$) sigue siendo no significativo en la mayoría de los modelos, tanto con $n=50$ como con $n=300$. 

Por último Las diferencias en los resultados entre las estimaciones con $n=50$ y $n=300$ se deben fundamentalmente al incremento de la potencia estadística y a la mayor precisión de las estimaciones que se obtiene con un tamaño muestral más grande. Al disponer de más observaciones, los errores estándar asociados a los coeficientes estimados tienden a ser menores. Esto implica que las estimaciones de los coeficientes son más precisas y se concentran más cercanamente alrededor de los verdaderos valores poblacionales de los parámetros. Como consecuencia, aquellos efectos que son realmente distintos de cero en la población, pero que no pudieron ser detectados como estadísticamente significativos con una muestra pequeña (debido a que sus errores estándar eran grandes en relación con la magnitud del coeficiente), pueden volverse estadísticamente significativos cuando la muestra es mayor.

\newpage

# Pregunta 6. 

Graficar la interacción entre Conflicto y reciprocidad para $n = 300$ y $\beta_{\text{Conflicto} \times \text{dCC}} = 30$ e interpretar gráfico.

```{r}
#| fig-height: 8
#| fig-width: 10
#| results: asis
#| label: fig-fig3
#| fig-cap: "Interacción entre Conflicto y reciprocidad"


# crear un nuevo dataframe para la prediccion
new_data <- expand.grid(
  Conflicto = seq(min(data3$Conflicto), max(data3$Conflicto), length.out = 100),
  dcc = levels(data3$dcc),
  svo = mean(data3$svo)  # Usar la media de SVO
)

# predecir con intervalos de confianza
pred_with_ci <- predict(modelo6.3, newdata = new_data, interval = "confidence")
predictions <- cbind(new_data, pred_with_ci)
names(predictions)[4:6] <- c("tiempo", "lower", "upper")

# graficar la interaccion
n_colores <- length(unique(predictions$dcc))
paleta    <- brewer.pal(n = max(3, n_colores), name = "Pastel1")[seq_len(n_colores)]

ggplot() +
  geom_point(data = data3,
             aes(x = Conflicto, y = tiempo, colour = dcc),
             alpha = 0.3, size = 1.8) +
  geom_ribbon(data = predictions,
              aes(x = Conflicto, ymin = lower, ymax = upper, fill = dcc),
              alpha = 0.20) +
  geom_line(data = predictions,
            aes(x = Conflicto, y = tiempo, colour = dcc),
            size = 1.2) +
  labs(
    title    = "Interacción entre Conflicto y Reciprocidad",
    subtitle = "n = 300, β(Conflicto × dcc) = 30",
    x = "Conflicto (puntuación z)",
    y = "Tiempo de Negociación (segundos)",
    colour = "Reciprocidad",
    fill   = "Reciprocidad"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    panel.grid.minor = element_blank(),
    text = element_text(size = 12)
  ) +
  scale_colour_manual(values = paleta) +
  scale_fill_manual(values  = paleta)
```


El gráfico representa las predicciones del tiempo de negociación según el nivel de Conflicto (en escala $z$), diferenciando entre participantes cooperadores condicionales (dCC = 1) y no condicionales (dCC = 0) según el __modelo 6.3__.

Para los participantes no condicionales, el efecto marginal de un aumento en Conflicto sobre el tiempo de negociación está dado por:

$$
\frac{\partial \ \text{Tiempo}}{\partial \ \text{Conflicto}} = \hat{\beta}_{\text{Conflicto}} = 20.82
$$

Para los cooperadores condicionales, el efecto incluye también la interacción:

$$
\frac{\partial \ \text{Tiempo}}{\partial \ \text{Conflicto}} = \hat{\beta}_{\text{Conflicto}} + \hat{\beta}_{\text{Conflicto} \times \text{dCC}} = 20.82 + 32.56 = 53.38
$$

Esto significa que un hay aumento en el tiempo de negociación en aproximadamente 53.38 segundos para los cooperadores condicionales, comparado con 20.82 segundos para los no condicionales por cada incremento  en  una desviación estándar en la percepción de Conflicto.

El gráfico evidencia dos líneas con pendientes distintas: la pendiente es más pronunciada para los cooperadores condicionales, lo que confirma una interacción positiva y significativa. Esto sugiere que los cooperadores condicionales son más sensibles a la percepción de conflicto. También, ante altos niveles de conflicto, estos individuos tardan más en cooperar y la moderación por reciprocidad amplifica el efecto del conflicto en el tiempo de negociación.

Este resultado valida empíricamente la hipótesis de interacción teórica y resalta la importancia del tamaño muestral para detectar efectos moderadores.

# Pregunta 7. 

Discutir principales resultados y plantear conclusiones del ejercicio y los modelos.

A lo largo del ejercicio se simularon distintos modelos econométricos con el objetivo de identificar los efectos en el tiempo de negociación dado cambios de la percepción de Conflicto de intereses, así como el rol moderador de la reciprocidad (dCC) y el control por prosocialidad** (SVO).

**Principales resultados**

1. Efecto directo del Conflicto: En todos los modelos, el coeficiente asociado a la variable Conflicto ($\hat\beta_{\text{Conflicto}}$) fue positivo, indicando que a mayor percepción de conflicto, mayor es el tiempo que demora una persona en alcanzar un acuerdo. Este efecto fue significativo en la mayoría de los escenarios simulados, especialmente cuando se utilizó un tamaño muestral grande ($n = 300$).

2. Efecto de la prosocialidad (SVO): De forma consistente, el coeficiente $\hat\beta_{\text{SVO}}$ fue negativo y estadísticamente significativo, lo que indica que hay un menor tiempo de negociación en individuos con mayor orientación prosocial, independientemente del nivel de conflicto percibido. Tambien que hay un sesgo positivo por variable omitida sobre Conflcito si SVO está ausente.

3. Efecto de la reciprocidad (dCC): El coeficiente $\hat\beta_{\text{dCC}}$ no alcanzó significancia estadística en ningún modelo, lo cual sugiere que la sola pertenencia a un tipo de cooperador (condicional o no) no afecta directamente el tiempo de negociación.

4. Interacción entre Conflicto y Reciprocidad: El coeficiente de interacción $\beta_{\text{Conflicto} \times \text{dCC}}$ fue: No significativo con $n = 50$ tanto en su valor alto ($30$) como en su valor bajo ($10$). Significativo con $n = 300$ únicamente en el escenario donde $\beta_{\text{Conflicto} \times \text{dCC}} = 30$. Esto sugiere que la capacidad de detectar efectos de interacción moderados depende fuertemente del tamaño de la muestra y del tamaño del efecto real. Con una muestra pequeña, incluso interacciones grandes no logran ser identificadas como significativas.

5. Multicolinealidad: En los modelos con interacción (modelos 5 y 6), se observó un aumento en los errores estándar, probablemente debido a la colinealidad entre el término de interacción y sus componentes principales (Conflicto y dCC). Esto impacta negativamente en la significancia estadística de los coeficientes.

6. Rendimiento del Modelo 6: A pesar de su complejidad, el modelo 6 logró el **mayor ajuste global** en los escenarios con $n = 300$, alcanzando un $R^2_{\text{ajustado}} = 0.43$. Este modelo fue capaz de capturar adecuadamente la hipótesis teórica planteada y reveló una **interacción significativa** entre Conflicto y Reciprocidad.

**Conclusiones generales**

1. El modelo econométrico permite distinguir efectos principales robustos (Conflicto, SVO) de efectos moderadores más débiles o sensibles al tamaño muestral (Conflicto × dCC).
2. La evidencia empírica respalda la hipótesis de un aumento del que el tiempo de negociación dado un aumento delConflicto percibido y que este efecto es más pronunciado en cooperadores condicionales, siempre que se cuente con una muestra suficientemente grande.
3. La prosocialidad aparece como un factor protector, reduciendo el tiempo de negociación de manera significativa y consistente.
4. El análisis muestra la importancia de considerar interacciones teóricas relevantes, pero también subraya la necesidad de contar con suficiente potencia estadística para detectarlas.

\newpage

# Repositorio GitHub y Referencias.

Este [repositorio](https://github.com/AmaruSimonAgueroJimenez/Econometria-DCCS) contiene el código fuente de este ejercicio, así como los datos utilizados para la simulación y análisis. De igual manera se puede acceder con el siguiente código QR.

```{r}
#| fig-height: 3
#| fig-width: 3
#| fig-align: center
#| results: 'asis'
# URL del repositorio
repo_url <- "https://github.com/AmaruSimonAgueroJimenez/Econometria-DCCS"

# Generar código QR
qr <- qr_code(repo_url)

# Opción 1: Plot simple
plot(qr)
```

El informe .pdf se encuentra en [esta dirección](http://github.com/AmaruSimonAgueroJimenez/Econometria-DCCS/blob/main/docs/Prueba1_Amaru_Aguero.pdf). De igual manera se puede acceder con el siguiente código QR.

```{r}
#| fig-height: 3
#| fig-width: 3
#| fig-align: center
#| results: 'asis'
# URL del repositorio
repo_url <- "http://github.com/AmaruSimonAgueroJimenez/Econometria-DCCS/blob/main/docs/Prueba1_Amaru_Aguero.pdf"

# Generar código QR
qr <- qr_code(repo_url)

# Opción 1: Plot simple
plot(qr)
```

